---
import type { ComponentProps } from 'astro/types';
import PrimitiveTabListItem from '@/components/primitives/Tabs/TabListItem.astro';
import { cn } from '@/scripts/cn';
import type { WithAttributes } from '@/types';

type Props = WithAttributes<
  ComponentProps<typeof PrimitiveTabListItem> & {
    counter?: boolean;
    underline?: boolean;
  }
>;

const {
  class: className,
  counter = false,
  underline = false,
  liClassName = '',
  ...props
} = Astro.props;
---

<PrimitiveTabListItem
  {...props}
  liClassName={cn(
    'mb-2 flex-1 bg-white',
    { '[counter-increment:tab-list]': counter },
    liClassName
  )}
  class={cn(
    'group min-h-full w-full min-w-fit whitespace-nowrap rounded-lg border border-sw-text-disabled px-4 py-3 aria-selected:cursor-default',
    {
      'bg-white transition-colors hover:bg-sw-surface-subdued aria-selected:border-transparent aria-selected:bg-sw-sky-400 aria-selected:text-white':
        !underline,
      'relative overflow-hidden': underline,
      'typography-body-2': !counter,
      'typography-h3 isolate flex items-baseline gap-3 text-left': counter,
    },
    className
  )}
>
  {
    counter && (
      <>
        <span
          class={cn(
            'counter text-6xl text-sw-sky-400 before:content-[counter(tab-item)] before:[counter-increment:tab-item]',
            { 'transition-colors group-aria-selected:text-white': !underline }
          )}
        />
        <span class="absolute right-5 top-1/2 -z-[1] mt-3 hidden h-0.5 w-48 -translate-y-1/2 transform bg-gradient-to-r from-white/0 to-sw-text-disabled lg:block" />
      </>
    )
  }
  <slot />
  {
    underline && (
      <span class="active-line absolute bottom-0 left-0 h-1 w-full translate-y-1 bg-sw-sky-400 transition-transform group-aria-selected:translate-y-0" />
    )
  }
</PrimitiveTabListItem>
