---
import type { VariantProps } from 'class-variance-authority';
import type { HTMLAttributes } from 'astro/types';
import { Icon } from 'astro-icon/components';
import { cn } from '@/scripts/cn';
import { buttonVariants } from './ButtonStyles';

type ButtonProps = {
  leadingIcon?: string;
  trailingIcon?: string;
  asLink?: boolean;
};

type AttributesLink = HTMLAttributes<'a'>;
type AttributesButton = HTMLAttributes<'button'>;
type Attributes = AttributesButton & AttributesLink;

type Props = Attributes & ButtonProps & VariantProps<typeof buttonVariants>;

const {
  class: className,
  asLink = false,
  variant = 'primary',
  leadingIcon = '',
  trailingIcon = '',
  ...props
} = Astro.props;

const classes = cn(buttonVariants({ variant }), className);

// TODO: Fix types
// eslint-disable-next-line @typescript-eslint/no-explicit-any
const Tag: any = asLink ? 'a' : 'button';
---

<Tag {...props} class={classes}>
  {!!leadingIcon && <Icon name={leadingIcon} />}
  <slot />
  {!!trailingIcon && <Icon name={trailingIcon} />}
</Tag>
