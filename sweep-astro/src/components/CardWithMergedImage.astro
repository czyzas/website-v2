---
import type { HTMLAttributes } from 'astro/types';
import type { UnparsedImage } from '@/scripts/data-parsers/parseImage';
import { cn } from '@/scripts/cn';
import type { WithAttributes } from '@/types';
import WordpressImage from './WordpressImage.astro';
import Card from './ui/Card.astro';

interface CardWithMergedImage extends HTMLAttributes<'div'> {
  image?: UnparsedImage;
  size?: 'md' | 'lg';
}
type Props = WithAttributes<CardWithMergedImage>;

const { class: className, image, size = 'md', ...props } = Astro.props;
---

<Card
  {...props}
  class={cn(
    'card-with-merged-image',
    'h-full overflow-hidden bg-sw-surface-subdued p-0',
    'grid grid-cols-2 lg:min-h-[26.25rem]',
    {
      'lg:grid-cols-12': size === 'lg',
    },
    className
  )}
>
  <div
    class={cn('content-column col-span-full flex flex-col p-6 md:col-span-1', {
      'lg:col-span-4': size === 'lg',
    })}
  >
    <slot />
  </div>
  <div
    class={cn(
      'image-column col-span-full aspect-[16/9] md:col-span-1 md:aspect-auto',
      {
        'lg:col-span-8': size === 'lg',
      }
    )}
  >
    <WordpressImage data={image} class="h-full w-full object-cover" />
  </div>
</Card>
