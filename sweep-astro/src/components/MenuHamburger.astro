---
import type { HTMLAttributes } from 'astro/types';
import { cn } from '@/scripts/cn';

interface Props extends HTMLAttributes<'button'> {
  menuId: string;
}

const { menuId } = Astro.props;
---

<script>
  const menuToggleButtons = document.querySelectorAll<HTMLButtonElement>(
    'button[data-action="toggle-menu"]'
  );
  for (const button of menuToggleButtons) {
    button.addEventListener('click', () => {
      const menuId = button.getAttribute('aria-controls');
      const relatedMenu = document.getElementById(menuId ?? '');
      const state = button.ariaPressed === 'true';
      const nextState = !state ? 'true' : 'false';
      button.ariaPressed = nextState;
      if (relatedMenu) {
        relatedMenu.ariaHidden = state ? 'true' : 'false';
      }
    });
  }
</script>

<button
  type="button"
  data-action="toggle-menu"
  aria-pressed="false"
  aria-controls={menuId}
  class="group flex size-8 flex-col items-center justify-center gap-1 hover:text-sw-sky-400 aria-pressed:text-sw-sky-400 sm:size-12 lg:hidden"
>
  <span
    class={cn(
      'ease h-0.5 w-5 transform rounded-full bg-current transition duration-300',
      'group-aria-pressed:translate-y-1.5 group-aria-pressed:rotate-45'
    )}></span>
  <span
    class={cn(
      'ease h-0.5 w-5 transform rounded-full bg-current transition duration-300',
      'group-aria-pressed:opacity-0'
    )}></span>
  <span
    class={cn(
      'ease h-0.5 w-5 transform rounded-full bg-current transition duration-300',
      'group-aria-pressed:-translate-y-1.5 group-aria-pressed:-rotate-45'
    )}></span>
</button>
