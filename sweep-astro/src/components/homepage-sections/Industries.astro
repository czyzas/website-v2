---
import { cmsStore } from '@/stores/cmsStore';
import { getStore } from '@/scripts/store';
import { parseSectionTitle } from '@/scripts/data-parsers/parseSectionTitle';
import type { ComponentIndustriesListFragment } from '@/__generated__/cms';
import Container from '../ui/Container.astro';
import SectionTitle from '../partials/SectionTitle.astro';
import Section from '../ui/Section.astro';
import IndustriesList from '../IndustriesList.astro';

const store = getStore(cmsStore);

const data = store.homepage!;
const acf = data.homepage!.industries!;
const showSelected = (acf?.show ?? 'all') === 'selected';
const selectedIndustries = acf.selectedIndustries
  ?.nodes as ComponentIndustriesListFragment[];
---

<Section name="industries" bg="surface-subdued">
  <Container>
    <SectionTitle
      withMargin
      {...parseSectionTitle(acf.sectionTitle?.selectSectionTitle)}
    />
    <IndustriesList
      industries={showSelected ? selectedIndustries : undefined}
    />
  </Container>
</Section>
