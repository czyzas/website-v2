---
import { fetchHubspotForm } from '@/lib/fetchHubspotForm';
import { cmsStore } from '@/stores/cmsStore';
import { getStore } from '@/scripts/store';
import ClientGated from './Gated';

const store = getStore(cmsStore);
const { gatedFormGuid } =
  store.themeOptions?.themeOptionsAcf?.gatedContent ?? {};

const form = gatedFormGuid ? await fetchHubspotForm(gatedFormGuid) : undefined;
---

{
  !!gatedFormGuid && !!form && (
    <ClientGated guid={gatedFormGuid} form={form} client:load>
      <slot />
    </ClientGated>
  )
}
