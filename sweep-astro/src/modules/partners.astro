---
import type {
  ModulesModulesContentPartnersLayout,
  PartnersListFragment,
} from '@/__generated__/cms';
import ButtonContainer from '@/components/ButtonContainer.astro';
import ModuleContainer from '@/components/ModuleContainer.astro';
import PartnersList from '@/components/PartnersList.astro';
import WordpressButtonLink from '@/components/WordpressButtonLink.astro';
import { cleanArray } from '@/scripts/cleanArray';
import { linkShouldRender } from '@/scripts/data-parsers/parseLink';
import type { WithModuleMeta } from '@/types';

type Props = WithModuleMeta<ModulesModulesContentPartnersLayout>;

const {
  __meta__,
  layoutName,
  backgroundColor,
  partners: rawPartners,
  button,
} = Astro.props;

const partners = cleanArray(rawPartners?.nodes);
---

{
  partners.length > 0 && (
    <ModuleContainer meta={__meta__} name={layoutName!} bg={backgroundColor}>
      <PartnersList partners={partners as unknown as PartnersListFragment[]} />
      {linkShouldRender(button) && (
        <ButtonContainer>
          <WordpressButtonLink data={button} />
        </ButtonContainer>
      )}
    </ModuleContainer>
  )
}
