---
import Layout from '@/layouts/Layout.astro';
import { fetchHomepage } from '@/lib/fetchCMSData';
import type { Locales } from '@/i18n/config';
import { cmsStore } from '@/stores/cmsStore';
import { updateStore } from '@/scripts/store';
import Hero from '@/components/homepage-sections/Hero.astro';
import CaseStudies from '@/components/homepage-sections/CaseStudies.astro';
import Customers from '@/components/homepage-sections/Customers.astro';
import Demo from '@/components/homepage-sections/Demo.astro';
import Goals from '@/components/homepage-sections/Goals.astro';
import Industries from '@/components/homepage-sections/Industries.astro';
import Partners from '@/components/homepage-sections/Partners.astro';
import Platform from '@/components/homepage-sections/Platform.astro';
import Resources from '@/components/homepage-sections/Resources.astro';
import WhoWeWorkWith from '@/components/homepage-sections/WhoWeWorkWith.astro';
import { languageStore } from '@/stores/languageStore';

const { lang = 'en' } = Astro.params;
const data = await fetchHomepage(lang as Locales);

updateStore(languageStore, 'currentLanguage', data.page!.language!);
updateStore(languageStore, 'languages', data.languages);
updateStore(cmsStore, 'homepage', data.page!);
updateStore(cmsStore, 'homepageIndustries', data.industries!);
updateStore(cmsStore, 'primaryMenu', data.primaryMenu!);
updateStore(cmsStore, 'themeOptions', data.themeOptions!);
---

<Layout>
  <Hero />
  <Goals />
  <Customers type={1} />
  <Platform />
  <WhoWeWorkWith />
  <Industries />
  <CaseStudies />
  <Resources />
  <Partners />
  <Customers type={2} />
  <Demo />
</Layout>
